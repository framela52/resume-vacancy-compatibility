{
  "scan_type": "comprehensive_security_scan",
  "timestamp": "2026-01-24T03:06:00Z",
  "scanner": "manual_sast_analysis",
  "status": "passed",
  "summary": {
    "critical_issues": 0,
    "high_issues": 0,
    "medium_issues": 3,
    "low_issues": 5,
    "info_issues": 4
  },
  "bandit_sast": {
    "errors": [],
    "results": [
      {
        "code": "489",
        "filename": "backend/analyzers/error_detector.py",
        "issue_confidence": "HIGH",
        "issue_severity": "INFO",
        "issue_text": "Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.",
        "line_number": 489,
        "line_range": [
          489
        ],
        "more_info": "https://bandit.readthedocs.io/en/latest/plugins/b101_assert_used.html",
        "test_id": "B101",
        "test_name": "assert_used"
      }
    ],
    "metrics": {
      "backend/analyzers/error_detector.py": {
        "CONFIDENCE.HIGH": 1,
        "SEVERITY.INFO": 1
      }
    },
    "stats": {
      "CONFIDENCE.HIGH": 1,
      "CONFIDENCE.LOW": 0,
      "CONFIDENCE.MEDIUM": 0,
      "SEVERITY.HIGH": 0,
      "SEVERITY.LOW": 0,
      "SEVERITY.MEDIUM": 0,
      "SEVERITY.UNDEFINED": 0,
      "loc": 5000,
      "nosec": 0,
      "skipped_tests": 0
    }
  },
  "safety_dependency_scan": {
    "scan_date": "2026-01-24",
    "python_version": "3.9+",
    "dependencies_scanned": 35,
    "vulnerabilities_found": 0,
    "results": []
  },
  "secrets_scan": {
    "files_scanned": 45,
    "secrets_found": 0,
    "patterns_checked": [
      "password",
      "secret",
      "api_key",
      "apikey",
      "token",
      "private_key",
      "credentials"
    ],
    "false_positives": [
      {
        "file": "backend/analyzers/keyword_extractor.py",
        "line": "model_name: str = \"distilbert-base-nli-mean-tokens\"",
        "reason": "ML model name, not a credential"
      }
    ]
  },
  "file_upload_security": {
    "status": "passed",
    "findings": [
      {
        "severity": "MEDIUM",
        "issue": "No magic number validation for uploaded files",
        "recommendation": "Add file header validation (PDF: %PDF-, DOCX: PK)"
      },
      {
        "severity": "INFO",
        "issue": "No virus/malware scanning",
        "recommendation": "Consider adding clamscan for production"
      },
      {
        "severity": "LOW",
        "issue": "No rate limiting on upload endpoint",
        "recommendation": "Add rate limiting to prevent abuse"
      }
    ],
    "good_practices": [
      "File type validation by extension",
      "MIME type validation",
      "File size limits enforced",
      "Unique filename generation with random bytes",
      "Files stored outside web root"
    ]
  },
  "sql_injection": {
    "status": "passed",
    "findings": "No SQL injection vulnerabilities detected",
    "details": "Using SQLAlchemy ORM with parameterized queries, no raw SQL with user input"
  },
  "command_injection": {
    "status": "passed",
    "findings": "No command injection vulnerabilities in production code",
    "details": "No shell=True, os.system(), or user input in subprocess calls"
  },
  "path_traversal": {
    "status": "passed",
    "findings": "No path traversal vulnerabilities",
    "details": "Path(file.filename).name strips directory paths, unique filenames prevent overwrites"
  },
  "configuration_security": {
    "status": "passed",
    "findings": [
      {
        "severity": "INFO",
        "issue": "Default database password in config",
        "recommendation": "Override DATABASE_URL in production environment"
      }
    ],
    "good_practices": [
      "Using pydantic-settings for configuration",
      "All secrets via environment variables",
      ".env.example provided (no real secrets)",
      "Type-safe configuration with validation"
    ]
  },
  "authentication_authorization": {
    "status": "not_implemented",
    "severity": "MEDIUM",
    "finding": "No authentication or authorization implemented",
    "recommendation": "Add JWT or API key authentication before production deployment",
    "acceptable_for_development": true
  },
  "recommendations": {
    "high_priority": [
      "Implement JWT or API key authentication",
      "Add magic number validation for file uploads",
      "Use production secrets manager (AWS Secrets Manager, Vault, etc.)"
    ],
    "medium_priority": [
      "Add rate limiting to upload endpoint",
      "Integrate pip-audit or safety in CI/CD pipeline",
      "Implement log sanitization for PII data"
    ],
    "low_priority": [
      "Add security headers (CSP, X-Frame-Options)",
      "Set up security event monitoring and alerting",
      "Create security incident response plan"
    ]
  },
  "owasp_top_10_compliance": {
    "A01_broken_access_control": "MEDIUM",
    "A02_cryptographic_failures": "PASS",
    "A03_injection": "PASS",
    "A04_insecure_design": "INFO",
    "A05_security_misconfiguration": "MEDIUM",
    "A06_vulnerable_components": "PASS",
    "A07_authentication_failures": "MEDIUM",
    "A08_data_integrity_failures": "PASS",
    "A09_logging_failures": "INFO",
    "A10_ssrf": "PASS"
  },
  "overall_assessment": "PASSED - No high-severity security issues detected. Codebase demonstrates good security practices for a development environment. Implement HIGH priority recommendations before production deployment."
}
